# 北京林业大学2024--2025 学年第二学期课程设计任务书

**设计题目(范围)：** 多用户文件系统设计与实现  

## 课程设计内容

设计一个文件系统，需实现以下功能：  
- 文件的创建、删除、修改和查询。  
- 用户登录系统和注册功能，确保用户间的文件系统互不干扰。  
- 采用两级文件目录结构：第一级为用户账号，第二级为用户账号下的文件系统。  
- 简化设计，无需实现文件共享、文件系统安全、管道文件与设备文件等特殊内容。  

## 课程设计要求

### 1. 用户管理模块（满分6分）
- 实现注册功能、用户名密码存储和检测用户名冲突功能。（3分）  
- 用户登录后，只能看到用户账号下的文件，会话保持直到用户退出系统，设置登录错误尝试限制（尝试3次锁定）。（3分）  

### 2. 系统功能实现
- **文件类命令**（每实现一个命令3分，满分48分）：  
  - `create` 创建文件  
  - `delete` 删除文件  
  - `open` 打开文件  
  - `close` 关闭文件  
  - `read` 读文件  
  - `write` 写文件  
  - `move` 移动文件  
  - `copy` 拷贝文件  
  - `flock` 文件加锁（需实现加锁和解锁功能）  
  - `head --num` 显示文件的前num行  
  - `tail -num` 显示文件末尾的num行  
  - `lseek` 文件读写指针的移动（从当前位置向后或向前移动offset）  

- **目录类命令**：  
  - `cd` 进入目录  
  - `dir` 显示当前目录  
  - `mkdir` 创建目录  
  - `rmdir` 删除目录  

- **本地与虚拟磁盘交互**（每实现一个命令10分，满分20分）：  
  - `import c:\a.txt .` 将本地C盘下的a.txt导入到当前目录。  
  - `export a.txt c:\` 将当前目录下的a.txt导出到本地C盘。  

- **多线程支持**（满分16分）：  
  - 使用多线程设计：一个线程与用户交互，另一个线程维护虚拟磁盘驱动器。  
  - 支持多进程同时操作，确保数据同步。  

### 3. 完整目录树实现（满分10分）
以树形结构显示目录下所有内容，包括子目录、文件、文件大小和修改时间等信息。示例：  
/ (虚拟根目录)
├── user1/
│ ├── doc/
│ │ └── exam.txt
│ └── test.c
└── user2/
└── data.dat

## 课程设计实现要求
1. 仅使用C或C++语言开发，物理文件为二进制文件。  
2. 报告中需说明模拟的文件系统格式。  
3. 支持静态保存虚拟文件系统内容（程序重启后数据不丢失）。  
